{"version":3,"sources":["../../../../src/components/ui/AlertModal.tsx","../../../../src/app/admin/users/page.tsx"],"sourcesContent":["'use client';\nimport { motion, AnimatePresence } from 'framer-motion';\n\ninterface AlertModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onAction?: () => void;\n    title: string;\n    message: string;\n    type?: 'info' | 'success' | 'error' | 'warning';\n    actionLabel?: string;\n    cancelLabel?: string;\n}\n\nconst AlertModal = ({\n    isOpen,\n    onClose,\n    onAction,\n    title,\n    message,\n    type = 'info',\n    actionLabel = 'Acknowledge',\n    cancelLabel = 'Cancel'\n}: AlertModalProps) => {\n    // Determine colors based on type\n    const getTheme = () => {\n        switch (type) {\n            case 'success':\n                return { border: 'border-accent-moss/30', bg: 'bg-accent-moss/10', text: 'text-accent-moss', btn: 'bg-accent-moss text-white hover:bg-clinical-ink' };\n            case 'error':\n                return { border: 'border-signal-error/30', bg: 'bg-signal-error/10', text: 'text-signal-error', btn: 'bg-signal-error text-white hover:bg-red-900' };\n            case 'warning':\n                return { border: 'border-accent-bronze/30', bg: 'bg-accent-bronze/10', text: 'text-accent-bronze', btn: 'bg-accent-bronze text-white hover:bg-clinical-ink' };\n            default: // info\n                return { border: 'border-clinical-ink/10', bg: 'bg-clinical-ink/5', text: 'text-clinical-ink', btn: 'bg-clinical-ink text-white hover:bg-black' };\n        }\n    };\n\n    const theme = getTheme();\n\n    return (\n        <AnimatePresence>\n            {isOpen && (\n                <>\n                    {/* Backdrop */}\n                    <motion.div\n                        initial={{ opacity: 0 }}\n                        animate={{ opacity: 1 }}\n                        exit={{ opacity: 0 }}\n                        onClick={onClose}\n                        className=\"fixed inset-0 bg-clinical-ink/40 backdrop-blur-md z-[60] transition-colors\"\n                    />\n\n                    {/* Modal */}\n                    <div className=\"fixed inset-0 flex items-center justify-center p-4 z-[60] pointer-events-none\">\n                        <motion.div\n                            initial={{ scale: 0.95, opacity: 0, y: 10 }}\n                            animate={{ scale: 1, opacity: 1, y: 0 }}\n                            exit={{ scale: 0.95, opacity: 0, y: 10 }}\n                            className=\"bg-clinical-canvas border border-clinical-ink/10 shadow-2xl rounded-3xl p-8 md:p-12 w-full max-w-md pointer-events-auto relative overflow-hidden\"\n                        >\n                            {/* Decorative Elements */}\n                            <div className=\"absolute top-0 right-0 p-6 opacity-5 pointer-events-none\">\n                                <svg width=\"64\" height=\"64\" viewBox=\"0 0 64 64\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                                    <circle cx=\"32\" cy=\"32\" r=\"31\" stroke=\"currentColor\" strokeWidth=\"1\" />\n                                </svg>\n                            </div>\n\n                            <div className={`inline-flex items-center gap-2 mb-6 px-3 py-1 rounded-full border ${theme.border} ${theme.bg}`}>\n                                <span className={`font-mono text-[10px] uppercase tracking-widest ${theme.text}`}>\n                                    {type}\n                                </span>\n                            </div>\n\n                            <h3 className=\"font-display font-black text-2xl md:text-3xl text-clinical-ink mb-4 uppercase leading-[0.9]\">\n                                {title}\n                            </h3>\n                            <p className=\"font-sans text-sm text-clinical-ink/60 mb-10 leading-relaxed\">\n                                {message}\n                            </p>\n\n                            <div className=\"flex gap-4\">\n                                {onAction && (\n                                    <button\n                                        onClick={onClose}\n                                        className=\"flex-1 py-4 bg-transparent border border-clinical-ink/20 text-clinical-ink hover:bg-clinical-ink/5 font-sans text-[10px] uppercase tracking-[0.2em] font-bold transition-all duration-300 rounded-full\"\n                                    >\n                                        {cancelLabel}\n                                    </button>\n                                )}\n                                <button\n                                    onClick={onAction || onClose}\n                                    className={`flex-1 py-4 ${theme.btn} font-sans text-[10px] uppercase tracking-[0.2em] font-bold transition-all duration-300 rounded-full shadow-lg`}\n                                >\n                                    {actionLabel}\n                                </button>\n                            </div>\n                        </motion.div>\n                    </div>\n                </>\n            )}\n        </AnimatePresence>\n    );\n};\n\nexport default AlertModal;\n","'use client';\n\nimport { useState, useEffect, useContext } from 'react';\nimport { useRouter } from 'next/navigation';\nimport api from '../../../lib/api';\nimport { AuthContext, AuthContextType, User } from '../../../features/auth';\nimport { FaTrash, FaCheck, FaTimes } from 'react-icons/fa';\nimport { toast } from 'react-toastify';\nimport AlertModal from '../../../components/ui/AlertModal';\nimport { useCallback } from 'react';\n\nconst UserListPage = () => {\n    const { user, loading: authLoading } = useContext(AuthContext) as AuthContextType;\n    const router = useRouter();\n\n    const [users, setUsers] = useState<User[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false);\n    const [userToDelete, setUserToDelete] = useState<string | null>(null);\n\n    // Auth Protection\n    useEffect(() => {\n        if (!authLoading) {\n            if (!user || !user.isAdmin) {\n                router.push('/login');\n            }\n        }\n    }, [user, authLoading, router]);\n\n    const fetchUsers = useCallback(async () => {\n        try {\n            const { data } = await api.get('/api/users');\n            setUsers(data);\n            setLoading(false);\n        } catch {\n            toast.error('Failed to load personnel data.');\n            setLoading(false);\n        }\n    }, []);\n\n    useEffect(() => {\n        const syncUsers = async () => {\n            if (user && user.isAdmin) {\n                await fetchUsers();\n            }\n        };\n        syncUsers();\n    }, [user, fetchUsers]);\n\n    const confirmDeleteHandler = (id: string) => {\n        setUserToDelete(id);\n        setIsDeleteModalOpen(true);\n    };\n\n    const executeDelete = async () => {\n        if (!userToDelete) return;\n\n        try {\n            await api.delete(`/api/users/${userToDelete}`);\n            toast.success('Personnel record purged.');\n            setUsers((prev) => prev.filter((u) => u._id !== userToDelete));\n            setIsDeleteModalOpen(false);\n            setUserToDelete(null);\n        } catch {\n            toast.error('Purge failed.');\n            setIsDeleteModalOpen(false);\n        }\n    };\n\n    if (authLoading || !user || !user.isAdmin) {\n        return <div className=\"min-h-screen pt-20 md:pt-32 text-center font-mono text-clinical-ink/40 animate-pulse\">Verifying Credentials...</div>;\n    }\n\n    return (\n        <div className=\"min-h-screen pt-20 md:pt-32 pb-40 font-mono text-clinical-ink bg-clinical-canvas\">\n            <div className=\"container mx-auto px-container-sm md:px-container-md lg:px-container-lg max-w-7xl\">\n\n                <div className=\"mb-12\">\n                    <span className=\"font-sans text-[10px] uppercase tracking-[0.2em] text-clinical-ink/40 mb-2 block\">\n                        Admin Protocol\n                    </span>\n                    <h1 className=\"font-display font-black text-5xl md:text-heading-sub uppercase leading-[0.9]\">Personnel Database</h1>\n                </div>\n\n                <div className=\"overflow-x-auto border border-clinical-ink/10 bg-white rounded-3xl shadow-soft\">\n                    <table className=\"w-full text-left border-collapse\">\n                        <thead>\n                            <tr className=\"border-b border-clinical-ink/10 text-[10px] uppercase tracking-widest text-clinical-ink/40\">\n                                <th className=\"p-6 font-normal\">ID</th>\n                                <th className=\"p-6 font-normal\">Name</th>\n                                <th className=\"p-6 font-normal\">Email (Contact)</th>\n                                <th className=\"p-6 font-normal text-center\">Admin Access</th>\n                                <th className=\"p-6 font-normal text-right\">Actions</th>\n                            </tr>\n                        </thead>\n                        <tbody className=\"divide-y divide-clinical-ink/5 text-[11px] uppercase tracking-wide\">\n                            {users.map((u) => (\n                                <tr key={u._id} className=\"group hover:bg-clinical-canvas/50 transition-colors\">\n                                    <td className=\"p-6 text-clinical-ink/30 font-mono\">{u._id.substring(20, 24)}...</td>\n                                    <td className=\"p-6 font-bold text-clinical-ink\">{u.name}</td>\n                                    <td className=\"p-6 font-mono text-clinical-ink/70 lowercase\">{u.email}</td>\n                                    <td className=\"p-6 text-center\">\n                                        {u.isAdmin ? (\n                                            <FaCheck className=\"mx-auto text-signal-success\" />\n                                        ) : (\n                                            <FaTimes className=\"mx-auto text-clinical-ink/20\" />\n                                        )}\n                                    </td>\n                                    <td className=\"p-6 text-right\">\n                                        <button\n                                            onClick={() => confirmDeleteHandler(u._id)}\n                                            className=\"text-clinical-ink/40 hover:text-signal-error transition-colors p-2\"\n                                            disabled={u.isAdmin}\n                                        >\n                                            <FaTrash />\n                                        </button>\n                                    </td>\n                                </tr>\n                            ))}\n                        </tbody>\n                    </table>\n                </div>\n\n                {loading && (\n                    <div className=\"mt-8 text-center font-mono text-xs text-clinical-ink/40 animate-pulse\">\n                        Synchronizing Database...\n                    </div>\n                )}\n            </div>\n\n            <AlertModal\n                isOpen={isDeleteModalOpen}\n                onClose={() => setIsDeleteModalOpen(false)}\n                title=\"Purge Personnel Record\"\n                message=\"Confirm deletion of this user. This action cannot be undone.\"\n                type=\"error\"\n                actionLabel=\"Confirm Purge\"\n                onAction={executeDelete}\n            />\n        </div>\n    );\n};\n\nexport default UserListPage;\n"],"names":[],"mappings":"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"}