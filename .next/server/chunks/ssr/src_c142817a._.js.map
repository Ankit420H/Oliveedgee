{"version":3,"sources":["../../../../src/features/order/api.ts","../../../../src/app/admin/orders/page.tsx"],"sourcesContent":["import api from '../../lib/api';\nimport { Order, OrderAnalytics, PaymentResult } from './types';\n\nexport const createOrder = async (order: Partial<Order>): Promise<Order> => {\n    const { data } = await api.post('/api/orders', order);\n    return data;\n};\n\nexport const getOrderDetails = async (id: string): Promise<Order> => {\n    const { data } = await api.get(`/api/orders/${id}`);\n    return data;\n};\n\nexport const payOrder = async (id: string, paymentResult: PaymentResult): Promise<Order> => {\n    const { data } = await api.put(`/api/orders/${id}/pay`, paymentResult);\n    return data;\n};\n\nexport const deliverOrder = async (id: string): Promise<Order> => {\n    const { data } = await api.put(`/api/orders/${id}/deliver`);\n    return data;\n};\n\nexport const listMyOrders = async (): Promise<Order[]> => {\n    const { data } = await api.get('/api/orders/myorders');\n    return data;\n};\n\nexport const listOrders = async (): Promise<Order[]> => {\n    const { data } = await api.get('/api/orders');\n    return data;\n};\n\nexport const getOrderAnalytics = async (): Promise<OrderAnalytics[]> => {\n    const { data } = await api.get('/api/orders/analytics');\n    return data;\n};\n\nexport const cancelOrder = async (id: string): Promise<Order> => {\n    const { data } = await api.put(`/api/orders/${id}/cancel`);\n    return data;\n};\n\nexport const requestReturn = async (id: string): Promise<Order> => {\n    const { data } = await api.put(`/api/orders/${id}/return`);\n    return data;\n};\n","'use client';\n\nimport { useState, useEffect, useContext } from 'react';\nimport Link from 'next/link';\nimport { useRouter } from 'next/navigation';\nimport { AuthContext, AuthContextType } from '../../../features/auth';\nimport { listOrders } from '../../../features/order';\nimport { Order } from '../../../features/order/types';\nimport { FaTimes } from 'react-icons/fa';\nimport { toast } from 'react-toastify';\nimport { useCallback } from 'react';\n\nconst OrderListPage = () => {\n    const { user, loading: authLoading } = useContext(AuthContext) as AuthContextType;\n    const router = useRouter();\n\n    const [orders, setOrders] = useState<Order[]>([]);\n    const [loading, setLoading] = useState(true);\n\n    // Auth Protection\n    useEffect(() => {\n        if (!authLoading) {\n            if (!user || !user.isAdmin) {\n                router.push('/login');\n            }\n        }\n    }, [user, authLoading, router]);\n\n    const fetchOrders = useCallback(async () => {\n        try {\n            const data = await listOrders();\n            setOrders(data);\n            setLoading(false);\n        } catch {\n            toast.error('Failed to load order logs.');\n            setLoading(false);\n        }\n    }, []);\n\n    useEffect(() => {\n        const syncOrders = async () => {\n            if (user && user.isAdmin) {\n                await fetchOrders();\n            }\n        };\n        syncOrders();\n    }, [user, fetchOrders]);\n\n    if (authLoading || !user || !user.isAdmin) {\n        return <div className=\"min-h-screen pt-20 md:pt-32 text-center font-mono text-clinical-ink/40 animate-pulse\">Verifying Credentials...</div>;\n    }\n\n    return (\n        <div className=\"min-h-screen bg-clinical-canvas text-clinical-ink pt-20 md:pt-32 pb-40 font-mono\">\n            <div className=\"container mx-auto px-container-sm md:px-container-md lg:px-container-lg max-w-7xl\">\n                <div className=\"mb-12\">\n                    <span className=\"font-sans text-[10px] uppercase tracking-[0.2em] text-clinical-ink/40 mb-2 block\">\n                        Admin Protocol\n                    </span>\n                    <h1 className=\"font-display font-black text-5xl md:text-heading-sub uppercase leading-[0.9]\">Global Transactions</h1>\n                </div>\n\n                <div className=\"overflow-x-auto border border-clinical-ink/10 bg-white rounded-3xl shadow-soft\">\n                    <table className=\"w-full text-left border-collapse\">\n                        <thead>\n                            <tr className=\"border-b border-clinical-ink/10 text-[10px] uppercase tracking-widest text-clinical-ink/40\">\n                                <th className=\"p-6 font-normal\">Order ID</th>\n                                <th className=\"p-6 font-normal\">User</th>\n                                <th className=\"p-6 font-normal\">Date</th>\n                                <th className=\"p-6 font-normal\">Total</th>\n                                <th className=\"p-6 font-normal\">Paid</th>\n                                <th className=\"p-6 font-normal\">Delivered</th>\n                                <th className=\"p-6 font-normal text-right\">Details</th>\n                            </tr>\n                        </thead>\n                        <tbody className=\"divide-y divide-clinical-ink/5 text-[11px] uppercase tracking-wide\">\n                            {orders.map((order) => (\n                                <tr key={order._id} className=\"group hover:bg-clinical-canvas/50 transition-colors\">\n                                    <td className=\"p-6 text-clinical-ink/30 font-mono\">{order._id.substring(20, 24)}...</td>\n                                    <td className=\"p-6 font-bold text-clinical-ink\">{order.user && order.user.name}</td>\n                                    <td className=\"p-6 text-clinical-ink/70\">{order.createdAt.substring(0, 10)}</td>\n                                    <td className=\"p-6 font-mono text-clinical-ink\">â‚¹ {order.totalPrice}</td>\n                                    <td className=\"p-6\">\n                                        {order.isPaid ? (\n                                            <span className=\"text-signal-success\">{order.paidAt?.substring(0, 10)}</span>\n                                        ) : (\n                                            <FaTimes className=\"text-signal-error\" />\n                                        )}\n                                    </td>\n                                    <td className=\"p-6\">\n                                        {order.isDelivered ? (\n                                            <span className=\"text-signal-success\">{order.deliveredAt?.substring(0, 10)}</span>\n                                        ) : (\n                                            <FaTimes className=\"text-clinical-ink/20\" />\n                                        )}\n                                    </td>\n                                    <td className=\"p-6 text-right\">\n                                        <Link href={`/admin/order/${order._id}`} className=\"px-4 py-2 bg-clinical-ink/5 hover:bg-clinical-ink hover:text-white rounded-full transition-colors text-[10px] font-bold\">\n                                            VIEW\n                                        </Link>\n                                    </td>\n                                </tr>\n                            ))}\n                        </tbody>\n                    </table>\n                </div>\n                {loading && (\n                    <div className=\"mt-8 text-center font-mono text-xs text-clinical-ink/40 animate-pulse\">\n                        Synchronizing Database...\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n};\n\nexport default OrderListPage;\n"],"names":[],"mappings":"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"}