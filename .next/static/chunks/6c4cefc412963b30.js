(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,43782,e=>{"use strict";var t=e.i(43476),a=e.i(46932),s=e.i(88653);e.s(["default",0,({isOpen:e,onClose:i,onAction:n,title:r,message:l,type:c="info",actionLabel:o="Acknowledge",cancelLabel:d="Cancel"})=>{let p=(()=>{switch(c){case"success":return{border:"border-accent-moss/30",bg:"bg-accent-moss/10",text:"text-accent-moss",btn:"bg-accent-moss text-white hover:bg-clinical-ink"};case"error":return{border:"border-signal-error/30",bg:"bg-signal-error/10",text:"text-signal-error",btn:"bg-signal-error text-white hover:bg-red-900"};case"warning":return{border:"border-accent-bronze/30",bg:"bg-accent-bronze/10",text:"text-accent-bronze",btn:"bg-accent-bronze text-white hover:bg-clinical-ink"};default:return{border:"border-clinical-ink/10",bg:"bg-clinical-ink/5",text:"text-clinical-ink",btn:"bg-clinical-ink text-white hover:bg-black"}}})();return(0,t.jsx)(s.AnimatePresence,{children:e&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:i,className:"fixed inset-0 bg-clinical-ink/40 backdrop-blur-md z-[60] transition-colors"}),(0,t.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4 z-[60] pointer-events-none",children:(0,t.jsxs)(a.motion.div,{initial:{scale:.95,opacity:0,y:10},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:10},className:"bg-clinical-canvas border border-clinical-ink/10 shadow-2xl rounded-3xl p-8 md:p-12 w-full max-w-md pointer-events-auto relative overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute top-0 right-0 p-6 opacity-5 pointer-events-none",children:(0,t.jsx)("svg",{width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("circle",{cx:"32",cy:"32",r:"31",stroke:"currentColor",strokeWidth:"1"})})}),(0,t.jsx)("div",{className:`inline-flex items-center gap-2 mb-6 px-3 py-1 rounded-full border ${p.border} ${p.bg}`,children:(0,t.jsx)("span",{className:`font-mono text-[10px] uppercase tracking-widest ${p.text}`,children:c})}),(0,t.jsx)("h3",{className:"font-display font-black text-2xl md:text-3xl text-clinical-ink mb-4 uppercase leading-[0.9]",children:r}),(0,t.jsx)("p",{className:"font-sans text-sm text-clinical-ink/60 mb-10 leading-relaxed",children:l}),(0,t.jsxs)("div",{className:"flex gap-4",children:[n&&(0,t.jsx)("button",{onClick:i,className:"flex-1 py-4 bg-transparent border border-clinical-ink/20 text-clinical-ink hover:bg-clinical-ink/5 font-sans text-[10px] uppercase tracking-[0.2em] font-bold transition-all duration-300 rounded-full",children:d}),(0,t.jsx)("button",{onClick:n||i,className:`flex-1 py-4 ${p.btn} font-sans text-[10px] uppercase tracking-[0.2em] font-bold transition-all duration-300 rounded-full shadow-lg`,children:o})]})]})})]})})}])},60081,e=>{"use strict";e.s(["loadRazorpayScript",0,()=>new Promise(e=>{let t=document.createElement("script");t.src="https://checkout.razorpay.com/v1/checkout.js",t.onload=()=>{e(!0)},t.onerror=()=>{e(!1)},document.body.appendChild(t)})])},38944,e=>{"use strict";e.i(47167);var t=e.i(43476),a=e.i(71645),s=e.i(18566);e.i(66425);var i=e.i(9771);e.i(47135);var n=e.i(5286),r=e.i(22016);let l=({step1:e,step2:a})=>{let s="font-sans text-xs font-bold uppercase tracking-widest text-clinical-ink",i="font-sans text-xs uppercase tracking-widest text-clinical-ink/40 cursor-default";return(0,t.jsx)("nav",{className:"flex justify-center mb-16",children:(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[e?(0,t.jsx)(r.default,{href:"/login",className:s,children:"Identity"}):(0,t.jsx)("span",{className:i,children:"Identity"}),(0,t.jsx)("span",{className:"text-xs text-clinical-ink/60",children:"/"}),a?(0,t.jsx)("span",{className:s,children:"Checkout"}):(0,t.jsx)("span",{className:i,children:"Checkout"})]})})};var c=e.i(9165),o=e.i(70319),d=e.i(60081),p=e.i(46932),x=e.i(43782),m=e.i(82041);e.s(["default",0,()=>{let{shippingAddress:e,saveShippingAddress:r,cartItems:u,clearCart:h}=(0,a.useContext)(i.CartContext),{user:b}=(0,a.useContext)(n.AuthContext),g=(0,s.useRouter)(),[f,y]=(0,a.useState)(e.address||""),[j,v]=(0,a.useState)(e.city||""),[N,k]=(0,a.useState)(e.postalCode||""),[w,C]=(0,a.useState)(e.country||""),[z,S]=(0,a.useState)(!1),[_,A]=(0,a.useState)(null),[F,P]=(0,a.useState)(!1),R=e=>(Math.round(100*e)/100).toFixed(2),$=R(u.reduce((e,t)=>e+t.price*t.qty,0)),O=R(Number($)>2e3?0:100),T=R(Number((.15*Number($)).toFixed(2))),q=(Number($)+Number(O)+Number(T)).toFixed(2);(0,a.useEffect)(()=>{0===u.length&&g.push("/cart")},[u,g]);let E=async e=>{if(e.preventDefault(),!f||!j||!N||!w)return void o.toast.error("Please fill in all shipping fields.");P(!0),r({address:f,city:j,postalCode:N,country:w});try{if(!await (0,d.loadRazorpayScript)()){o.toast.error("Razorpay SDK failed to load. Are you online?"),P(!1);return}let{data:e}=await c.default.post("/api/orders",{orderItems:u,shippingAddress:{address:f,city:j,postalCode:N,country:w},paymentMethod:"Razorpay",itemsPrice:$,shippingPrice:O,taxPrice:T,totalPrice:q}),{data:t}=await c.default.post("/api/payment/create-order",{amount:q,receipt:e._id}),a={key:"rzp_test_Rvob51iGONRFfg",amount:t.amount,currency:t.currency,name:"Olive Edge",description:`Order #${e._id}`,order_id:t.id,handler:async function(t){try{let a=await c.default.post("/api/payment/verify",{razorpay_order_id:t.razorpay_order_id,razorpay_payment_id:t.razorpay_payment_id,razorpay_signature:t.razorpay_signature,orderId:e._id});"success"===a.data.status&&(h(),A(e._id),S(!0))}catch(t){o.toast.error("Payment Verification Failed: "+(0,m.getErrorMessage)(t)),console.error(t),g.push(`/order/${e._id}`)}},prefill:{name:b?.name,email:b?.email,contact:b?.phone||""},theme:{color:"#606C38"}};new window.Razorpay(a).open(),P(!1)}catch(e){o.toast.error((0,m.getErrorMessage)(e)),P(!1)}};return(0,t.jsxs)("div",{className:"min-h-screen bg-clinical-canvas pt-20 md:pt-32 pb-40",children:[(0,t.jsxs)("div",{className:"container mx-auto px-container-sm md:px-container-md lg:px-container-lg",children:[(0,t.jsx)(l,{step1:!0,step2:!0}),(0,t.jsxs)("div",{className:"text-center mb-16",children:[(0,t.jsx)("span",{className:"font-sans text-[10px] uppercase tracking-[0.2em] text-clinical-ink/40 mb-4 block",children:"Final Step"}),(0,t.jsx)("h1",{className:"font-display font-black text-5xl md:text-7xl lg:text-heading-main text-clinical-ink mb-8 leading-[0.9] uppercase",children:"Checkout"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 lg:gap-24",children:[(0,t.jsxs)("div",{className:"space-y-12",children:[(0,t.jsx)("div",{className:"border-b border-black pb-4 mb-8",children:(0,t.jsx)("h2",{className:"font-sans text-[10px] font-bold uppercase tracking-[0.2em] text-clinical-ink/60",children:"Shipping Details"})}),(0,t.jsxs)("form",{id:"checkout-form",onSubmit:E,className:"space-y-8",children:[b&&b.addresses&&b.addresses.length>0&&(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("label",{className:"block font-sans text-[10px] uppercase tracking-widest text-clinical-ink/60 mb-2",children:"Select Saved Location"}),(0,t.jsxs)("select",{onChange:e=>{let t=parseInt(e.target.value);if(!isNaN(t)&&b.addresses){let e=b.addresses[t];y(e.address||""),v(e.city||""),k(e.postalCode||""),C(e.country||"")}},className:"w-full bg-white/50 border border-clinical-ink/20 rounded-lg p-3 font-sans text-sm text-clinical-ink focus:border-accent-bronze outline-none appearance-none",defaultValue:"",children:[(0,t.jsx)("option",{value:"",disabled:!0,children:"-- Use a Saved Address --"}),b.addresses.map((e,a)=>(0,t.jsxs)("option",{value:a,children:[e.address,", ",e.city]},a))]})]}),(0,t.jsxs)("div",{className:"aesop-input-group",children:[(0,t.jsx)("input",{type:"text",value:f,onChange:e=>y(e.target.value),required:!0,className:"aesop-input peer placeholder-transparent",placeholder:"Street Address",id:"address"}),(0,t.jsx)("label",{htmlFor:"address",children:"Street Address"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"aesop-input-group",children:[(0,t.jsx)("input",{type:"text",value:j,onChange:e=>v(e.target.value),required:!0,className:"aesop-input peer placeholder-transparent",placeholder:"City",id:"city"}),(0,t.jsx)("label",{htmlFor:"city",children:"City"})]}),(0,t.jsxs)("div",{className:"aesop-input-group",children:[(0,t.jsx)("input",{type:"text",value:N,onChange:e=>k(e.target.value),required:!0,className:"aesop-input peer placeholder-transparent",placeholder:"Postal Code",id:"postalCode"}),(0,t.jsx)("label",{htmlFor:"postalCode",children:"Postal Code"})]})]}),(0,t.jsxs)("div",{className:"aesop-input-group",children:[(0,t.jsx)("input",{type:"text",value:w,onChange:e=>C(e.target.value),required:!0,className:"aesop-input peer placeholder-transparent",placeholder:"Country",id:"country"}),(0,t.jsx)("label",{htmlFor:"country",children:"Country"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsx)("div",{className:"border-b border-black pb-4 mb-4",children:(0,t.jsx)("h2",{className:"font-sans text-[10px] font-bold uppercase tracking-[0.2em] text-clinical-ink/60",children:"Order Summary"})}),(0,t.jsx)("div",{className:"max-h-96 overflow-y-auto pr-4 space-y-6",children:u.map((e,a)=>(0,t.jsxs)("div",{className:"flex items-center gap-6 group",children:[(0,t.jsx)("div",{className:"w-16 h-20 bg-clinical-bone overflow-hidden rounded-lg flex-shrink-0",children:(0,t.jsx)("img",{src:e.image,alt:e.name,className:"w-full h-full object-contain mix-blend-multiply"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"font-serif text-base text-clinical-ink block truncate",children:e.name}),(0,t.jsxs)("span",{className:"font-mono text-[10px] text-clinical-ink/60",children:["Qty: ",e.qty," | Size: ",e.size||"N/A"]})]}),(0,t.jsxs)("div",{className:"font-mono text-sm text-clinical-ink",children:["₹ ",e.price*e.qty]})]},a))}),(0,t.jsxs)("div",{className:"bg-white/40 backdrop-blur-sm border border-clinical-ink/5 p-8 rounded-3xl mt-8",children:[(0,t.jsxs)("div",{className:"space-y-4 font-sans text-[10px] uppercase tracking-widest border-b border-clinical-ink/10 pb-6 mb-6",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-clinical-ink/60",children:"Subtotal"}),(0,t.jsxs)("span",{className:"font-mono text-clinical-ink",children:["₹ ",$]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-clinical-ink/60",children:"Shipping"}),(0,t.jsxs)("span",{className:"font-mono text-clinical-ink",children:["₹ ",O]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-clinical-ink/60",children:"Tax (15%)"}),(0,t.jsxs)("span",{className:"font-mono text-clinical-ink",children:["₹ ",T]})]})]}),(0,t.jsxs)("div",{className:"flex justify-between font-serif text-xl text-clinical-ink mb-8",children:[(0,t.jsx)("span",{children:"Total"}),(0,t.jsxs)("span",{className:"font-mono text-lg font-bold",children:["₹ ",q]})]}),(0,t.jsx)(p.motion.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",form:"checkout-form",disabled:0===u.length||F,className:"w-full py-5 bg-clinical-ink text-white font-sans text-xs uppercase tracking-[0.2em] hover:bg-black transition-all duration-500 disabled:opacity-50 disabled:cursor-not-allowed flex justify-center items-center gap-4 rounded-full shadow-xl",children:F?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Processing..."]}):`Pay ₹ ${q}`}),(0,t.jsx)("p",{className:"text-center mt-4 font-sans text-[9px] text-clinical-ink/40 uppercase tracking-widest",children:"Secured by Razorpay"})]})]})]})]}),(0,t.jsx)(x.default,{isOpen:z,onClose:()=>{S(!1),g.push(`/order/${_}`)},title:"Transaction Approved",message:`Payment validated successfully. Order #${_} has been initialized.`,type:"success",actionLabel:"Proceed to Receipt",onAction:()=>g.push(`/order/${_}`)})]})}],38944)}]);